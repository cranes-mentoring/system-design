### Урок 2: Анализ и Планирование

#### Цели урока:
- Понять процесс сбора требований и анализа системы
- Определить функциональные и нефункциональные требования к проекту
- Разработать схему базы данных и определить объемы хранения данных

--- 

#### Часть 1: Сбор требований

Для начала открываем любой редактор с возможностью рисовать диаграмы:  
- [drow.io](https://app.diagrams.net)  
- [miro](https://miro.com)  

Прежде чем приступать к проектированию, необходимо полностью понять требования к системе.
Мы должны общаться с заинтересованными сторонами, выявлять их потребности и уточнять детали. 

Начинаем с того, что нам не стоит проектировать вообще все, все службы и сервисы.
1) уточняем, что конкретно от нас хотят, какой модуль.
2) узнаем максимальное количество деталей по потенциальным пользователям.

### Узнаем про активность и нагрузку
Во время системного проектирования (system design) на интервью могут быть заданы вопросы,
связанные с показателями производительности и масштабируемости системы, такими как RPS (запросы в секунду),
MAU (месячно активные пользователи) и DAU (активные пользователи в разрезе суток (24h)).

Эти метрики помогают понять нагрузку на систему и ее использование.

1. **RPS (Requests Per Second)**:
  - RPS - это количество запросов, которые система получает за секунду. Этот показатель позволяет оценить объем трафика, с которым система должна справляться в пиковые часы. Запросы могут быть различного типа, например, HTTP-запросы к веб-серверу или запросы к базе данных.

   Важные вопросы к интервьюеру:
  - Какие типы запросов учитываются при расчете RPS?
  - Какой ожидается максимальный RPS в пиковые часы?

   Что делать с этой информацией:
  - Используйте RPS для определения требований к масштабируемости системы. Например, сколько серверов или ресурсов потребуется для обработки ожидаемой нагрузки.

2. **MAU (Monthly Active Users) и DAU (Daily Active Users)**:
  - MAU - это количество уникальных пользователей, которые взаимодействовали с системой за месяц.
  - DAU - это количество уникальных пользователей, которые взаимодействовали с системой за день.

   Эти метрики важны для оценки общей популярности и использования системы во времени.

   Важные вопросы к интервьюеру:
  - Какой ожидается рост MAU и DAU со временем?
  - Какие типы действий пользователей учитываются при определении активности?

   Что делать с этой информацией:
  - Используйте MAU и DAU для планирования ресурсов и масштабирования системы в будущем.
  - Эти метрики могут помочь определить, как быстро ваша система должна масштабироваться, чтобы поддерживать рост пользовательской базы.

Уже на этом этапе нам нужно уметь просчитать приблизительную нагрузку. 
Возможно пока у нас недостаточно информации и стоит перейти к следующему пункту. 

#### Узнаем, что нужно сделать

В нашем случае, основные требования к сервису для магазина цветов включают:
- Возможность добавления, редактирования и удаления товаров (цветов)
- Возможность создания заказов пользователей
- Хранение истории заказов в течение года
- Автоматическое удаление старых записей
- Обеспечение безопасного доступа к данным

### Часть 2: Системный дизайн интервью

В рамках системного дизайна на собеседовании часто обсуждаются ключевые метрики производительности, такие как RPS (запросы в секунду), MAU (месячно активные пользователи) и DAU (дневно активные пользователи). Эти метрики помогают оценить нагрузку на систему и ее использование.

**1. RPS (Requests Per Second):**
- RPS представляет собой количество запросов, которые система обрабатывает за секунду. Этот показатель позволяет оценить объем трафика, с которым система должна справляться в пиковые часы.

  **Примеры вопросов к интервьюеру:**
  - Какие типы запросов учитываются при расчете RPS?
  - Какой ожидается максимальный RPS в пиковые часы?

**2. MAU (Monthly Active Users) и DAU (Daily Active Users):**
- MAU - количество уникальных пользователей, активных в системе за месяц.
- DAU - количество уникальных пользователей, активных в системе за день.

  **Примеры вопросов к интервьюеру:**
  - Какой ожидается рост MAU и DAU со временем?
  - Какие действия пользователей считаются активностью для расчета MAU и DAU?

**Использование этой информации:**
- RPS помогает определить необходимую масштабируемость системы. Например, сколько серверов или ресурсов потребуется для обработки ожидаемой нагрузки.
- MAU и DAU позволяют планировать ресурсы и масштабирование системы в будущем, учитывая рост пользовательской базы.

В целом, эти метрики предоставляют информацию о нагрузке на систему и ожиданиях по использованию, что помогает проектировать систему с учетом потребностей пользователей и ее возможностей масштабирования.

----- 
#### В нашем примере:

На основе собранных требований мы можем выделить функциональные и нефункциональные требования. Функциональные требования определяют, что система должна делать, в то время как нефункциональные требования определяют каким образом система должна работать. Например:
- Функциональные требования:
    - Создание, редактирование и удаление товаров
    - Создание и отмена заказов
    - Хранение истории заказов
- Нефункциональные требования:
    - Хранение истории заказов в течение года
    - Обеспечение безопасности данных

#### Часть 3: Проектирование базы данных

На основе выявленных требований мы можем приступить к проектированию схемы базы данных. Для нашего магазина цветов нам понадобятся следующие сущности:
- Таблица "Товары" для хранения информации о цветах
- Таблица "Заказы" для хранения информации о заказах пользователей
- Таблица "История_Заказов" для хранения истории изменений заказов

#### Часть 4: Оценка объемов данных

Следующим шагом является оценка объемов данных, которые будут храниться в нашей базе данных.
Мы должны рассчитать, сколько записей будет создаваться за определенный период времени, и сколько памяти будет занимать база данных.
Это поможет нам выбрать подходящие инструменты для хранения и оптимизировать производительность системы.

Еще полезные цифры:  
https://habr.com/ru/articles/108537/  
http://julianhyde.blogspot.com/2010/11/numbers-everyone-should-know.html